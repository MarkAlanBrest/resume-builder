<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Certifications and Skills</title>
  <link rel="stylesheet" href="style.css">

  <style>
    .page-title {
      text-align: center;
      color: #0b3c6d;
      margin-bottom: 30px;
      font-size: 28px;
    }

    .system {
      color: #0b3c6d;
      font-weight: 600;
    }

    .program-box {
      background: #f1f6fb;
      border: 1px solid #c9d9ea;
      padding: 12px;
      margin-bottom: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="chat">

  <h1 class="page-title">NCSTâ€™s Resume Builder</h1>

  <!-- PROGRAM DISPLAY -->
  <div class="program-box" id="programDisplay"></div>

  <!-- PROGRAM CERTIFICATIONS -->
  <div class="system">
    The following certifications may be earned during your time at NCST.
    <br>
    <small>
      Select the certifications you expect to achieve by your graduation date.
    </small>
  </div>

  <div id="programCerts"></div>

  <!-- OUTSIDE CERTIFICATIONS -->
  <div class="system">
    Certifications earned outside of school (optional)
  </div>
  <textarea id="extraCerts"></textarea>

  <!-- OUTSIDE SKILLS -->
  <div class="system">
    Skills learned outside of school or work experience (optional)
  </div>
  <textarea id="extraSkills"></textarea>

  <br>

  <button type="button" onclick="goBack()">Back</button>
  <button type="button" onclick="goNext()">Next</button>

</div>

<script>
/* ===================== PROGRAM DATA ===================== */
const PROGRAM_CERTS = {
  welding: {
    name: "Combination Welding",
    certifications: [
      "AWS D1.1 Structural Steel",
      "AWS D1.3 Sheet Metal",
      "FCAW Plate Certification",
      "OSHA 10",
      "Hot Work Safety"
    ]
  }
};

/* ===================== STORAGE ===================== */
function getData() {
  return JSON.parse(localStorage.getItem("resumeData")) || {};
}
function setData(data) {
  localStorage.setItem("resumeData", JSON.stringify(data));
}

/* ===================== HELPERS ===================== */
function inferProgramKey(programText) {
  const s = programText.toLowerCase();
  if (s.includes("welding")) return "welding";
  return "";
}

/* ===================== LOAD ===================== */
window.onload = function () {
  const data = getData();

  data.certifications ||= {
    programKey: "",
    programName: "",
    programCertsSelected: [],
    extraCerts: "",
    extraSkills: ""
  };

  const programText = data.student?.program || data.programCampus || "";
  let programKey = data.certifications.programKey || inferProgramKey(programText);

  if (!PROGRAM_CERTS[programKey]) {
    programKey = "welding"; // safe fallback
  }

  const programData = PROGRAM_CERTS[programKey];

  // Save program context
  data.certifications.programKey = programKey;
  data.certifications.programName = programText || programData.name;
  setData(data);

  // Display program
  document.getElementById("programDisplay").textContent =
    `Program Selected: ${data.certifications.programName}`;

  // Restore textareas
  document.getElementById("extraCerts").value =
    data.certifications.extraCerts || "";

  document.getElementById("extraSkills").value =
    data.certifications.extraSkills || "";

  // Build cert list
  const selected = data.certifications.programCertsSelected || [];
  const container = document.getElementById("programCerts");
  container.innerHTML = "";

  programData.certifications.forEach((cert, i) => {
    const row = document.createElement("div");
    row.className = "check-row";

    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.id = "cert" + i;
    cb.value = cert;
    cb.checked = selected.includes(cert);

    const label = document.createElement("label");
    label.htmlFor = cb.id;
    label.textContent = cert;

    row.appendChild(cb);
    row.appendChild(label);
    container.appendChild(row);
  });
};

/* ===================== NAV ===================== */
function goBack() {
  window.location.href = "work.html";
}

function goNext() {
  const data = getData();

  data.certifications.programCertsSelected = Array.from(
    document.querySelectorAll("#programCerts input:checked")
  ).map(cb => cb.value);

  data.certifications.extraCerts =
    document.getElementById("extraCerts").value.trim();

  data.certifications.extraSkills =
    document.getElementById("extraSkills").value.trim();

  setData(data);
  window.location.href = "education-military-v2.html";
}
</script>

</body>
</html>